# BIT综测一键解压+统计

这是一个专为 Windows 系统设计的批处理工具，用于解压、重命名和处理综合测评相关的 `.zip` 和 `.rar` 文件，并生成汇总表。特别为北京理工大学特立书院的综测模板优化设计,其他学院不一定能用。

## 功能
1. **解压文件**：
   - 使用 Windows 自带 `tar` 解压 `.zip` 文件。
   - 使用 7-Zip 解压 `.rar` 文件。
2. **重命名文件夹**：
   - 将解压后的文件夹重命名为“姓名-学号”格式（学号需以“1120”开头）。
   - 覆盖同名文件夹，确保最新数据替换旧数据。
3. **数据处理**：
   - 调用 `fill_summary.py` 从解压后的 `.xlsx` 文件提取数据，生成汇总表。

## 使用环境
- **操作系统**：仅支持 Windows（推荐 Windows 10 或 11）。
- **依赖软件**：
  - Python 3.x（用于虚拟环境和 `fill_summary.py`）。
  - 7-Zip（用于解压 `.rar` 文件，需安装并位于 `C:\Program Files\7-Zip\7z.exe`）。
  - 其他环境将自动配置。

## 限制
- **文件格式**：仅支持 `.zip` 和 `.rar` 文件，不支持其他压缩格式（如 `.7z`、`.tar.gz`）。
- **文件结构**：每个压缩包的表层必须只包含一个 `.xlsx` 文件（可以有其他证明材料文件夹，但 `.xlsx` 文件必须唯一且在表层）。
- **命名要求**：压缩包文件名需包含中文姓名和以“1120”开头的学号（如 `张三-112021xxxx.rar`），否则可能无法正确重命名。
- **模板限制**：由于依赖特立书院综测模板（`.xlsx` 文件格式），目前仅在特立书院测试有效，其他学院或模板未知。
- **无密码支持**：当前脚本不支持密码保护的压缩文件。
- **运行权限**：需以管理员身份运行 `.bat` 文件，避免权限问题。

## 使用方法
1. **准备文件**：
   - git clone将 `fill_summary.py`、`process_all.bat`放进文件夹里面 （如 `C:\Users\Desktop\大三上综测`）
   - 将所有 `.zip`/`.rar` 文件放在同一目录。
   - 确保目录中有一个空的或现有的“综测成绩汇总表.xlsx”文件。
2. **运行脚本**：
   - 单击 `process_all.bat`。
3. **检查结果**：
   - 查看 `process_log.txt` 日志，确认解压和重命名是否成功。
   - 打开生成的“综测成绩汇总表.xlsx”检查数据。

## 示例目录结构
**运行前：**
C:\Users\Desktop\大三上综测\

process_all.bat
fill_summary.py
张三-112021xxxx-综测.zip
112022xxxx-李四-大二下综测统计.rar
综测成绩汇总表.xlsx

**运行后：**
C:\Users\Desktop\大三上综测\
process_all.bat
fill_summary.py
张三-112021xxxx\
张三-112021xxxx.xlsx
证明材料\ (可选)
李四-112022xxxx\
李四-112022xxxx.xlsx
证明材料\ (可选)
综测成绩汇总表.xlsx（已更新）
process_log.txt

**综测成绩汇总表.xlsx 示例（表头）：**
| 姓名       | A   | B   | C1  | C2  | C3  | C   | D1  | D2  | D3  | D4  | D5  | D6  | D   | S   |
|------------|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|-----|
| 张三       |     |     |     |     |     |     |     |     |     |     |     |     |     |     |
| 李四       |     |     |     |     |     |     |     |     |     |     |     |     |     |     |

## 注意事项
- **7-Zip 安装**：若未安装 7-Zip，脚本将跳过 `.rar` 文件处理。请从 [7-Zip 官网](https://www.7-zip.org/) 下载并安装。
- **文件完整性**：若压缩文件损坏，可能导致解压失败，请手动验证。
- **路径调整**：若 7-Zip 安装路径不是 `C:\Program Files\7-Zip\7z.exe`，需修改脚本中的 `SEVENZ_PATH`。
- **模板兼容性**：仅对特立书院综测模板测试有效，其他学院需自行验证。

## 问题反馈
如遇到问题，请提供 `process_log.txt` 日志内容，我会协助优化。
欢迎star
