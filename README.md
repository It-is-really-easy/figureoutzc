# BIT综测一键解压+统计

这是一个专为 Windows 系统设计的批处理工具，用于解压、重命名和处理综合测评相关的 `.zip` 和 `.rar` 文件，并生成汇总表。特别为北京理工大学特立书院的综测模板优化设计。

## 功能
1. **解压文件**：
   - 使用 Windows 自带 `tar` 解压 `.zip` 文件。
   - 使用 7-Zip 解压 `.rar` 文件。
2. **重命名文件夹**：
   - 将解压后的文件夹重命名为“姓名-学号”格式（学号需以“1120”开头）。
   - 覆盖同名文件夹，确保最新数据替换旧数据。
3. **数据处理**：
   - 调用 `fill_summary.py` 从解压后的 `.xlsx` 文件提取数据，生成汇总表。

## 使用环境
- **操作系统**：仅支持 Windows（推荐 Windows 10 或 11）。
- **依赖软件**：
  - Python 3.x（用于虚拟环境和 `fill_summary.py`）。
  - 7-Zip（用于解压 `.rar` 文件，需安装并位于 `C:\Program Files\7-Zip\7z.exe`）。

## 限制
- **文件格式**：仅支持 `.zip` 和 `.rar` 文件，不支持其他压缩格式（如 `.7z`、`.tar.gz`）。
- **文件结构**：每个压缩包的表层必须只包含一个 `.xlsx` 文件（可以有其他证明材料文件夹，但 `.xlsx` 文件必须唯一且在表层）。
- **命名要求**：压缩包文件名需包含中文姓名和以“1120”开头的学号（如 `xxx-1120xxxx.rar`），否则可能无法正确重命名。
- **模板限制**：由于依赖特立书院综测模板（`.xlsx` 文件格式），目前仅在特立书院测试有效，其他学院或模板未知。
- **无密码支持**：当前脚本不支持密码保护的压缩文件。
- **运行权限**：需以管理员身份运行 `.bat` 文件，避免权限问题。

## 使用方法
1. **准备文件**：
   - 将 `fill_summary.py`、`process_all.bat` 和所有 `.zip`/`.rar` 文件放在同一目录（如 `C:\Users\lizem\Desktop\大三上综测`）。
   - 确保目录中有一个空的或现有的“综测成绩汇总表.xlsx”文件。
2. **运行脚本**：
   - 右键 `process_all.bat`，选择“以管理员身份运行”。
3. **检查结果**：
   - 查看 `process_log.txt` 日志，确认解压和重命名是否成功。
   - 打开生成的“综测成绩汇总表.xlsx”检查数据。

## 示例目录结构
**运行前：**
